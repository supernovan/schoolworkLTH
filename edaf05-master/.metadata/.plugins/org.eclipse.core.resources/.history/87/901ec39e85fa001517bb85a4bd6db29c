package lab2;
import java.util.*;

public class Graph {
	HashSet<Head> graph;
	public Graph() {
		graph = new HashSet<Head>();
	}
	
	public boolean add(String str) {
		if (graph.contains(str)) {
			return false;
		} else {
			Head h = new Head(str);
			for (Head ver : graph) {
				String temp = ver.getStr();
				
				if (strCheck(temp, str)) {
					ver.addEdge(h);
				}
				if (strCheck(str, temp)) {
					h.addEdge(ver);
				}
				
			}
			graph.add(h);
			return true;
		}
	}
	public int bfs(String h, String tar) {
		Head iter = null;
		for (Head ver : graph) {
			if (ver.getStr().equals(h)) {
				iter = ver;
				break;
			}
		}
		if (iter == null) {
			return -1;
		}
		
		LinkedList<Head> q = new LinkedList<Head>();
		q.addFirst(iter);
		iter.visited();
		while (!q.isEmpty()) {
			Head temp = q.removeFirst();
			if (temp.getStr().equals(tar)) {
				int dist = temp.getDist();
				clear();
				return dist-1;
			}
			for (int i = 0; i<temp.getSize(); i++) {
				if (!temp.getNeighbor(i).getVisit()) {
					temp.getNeighbor(i).visited();
					q.addLast(temp.getNeighbor(i));
					temp.getNeighbor(i).addDist(temp.getDist());
				}
			}
			
			
		}
		clear();
		return -1;
	}
	
	private void clear() {
		for (Head ver : graph) {
			ver.clear();
			for (int j = 0; j<ver.getSize(); j++) {
				ver.getNeighbor(j).clear();
			}
		}
	}
	
	public void printGraph() {
		for (Head ver : graph) {
			System.out.print(ver.getStr());
			for (int j = 0; j<ver.getSize(); j++) {
				System.out.print(" " + ver.getNeighbor(j).getStr());
			}
			System.out.print("\n");
		}
	}
	
	private boolean strCheck(String first, String sec) {
		boolean[] check = new boolean[4];
		char a = first.charAt(1);
		char b = first.charAt(2);
		char c = first.charAt(3);
		char d = first.charAt(4);
		for (int i = 0; i<sec.length(); i++) {
			switch (sec.charAt(i)) {
			case 'a': 
				if (check[0]) {
					continue;
				}
				check[0] = true;
				break;
			case 'b':
				if (check[1]) {
					continue;
				}
				check[1] = true;
				break;
			case 'c':
				if (check[2]) {
					continue;
				}
				check[2] = true;
				break;
			case 'd':
				if (check[3]) {
					continue;
				}
				check[3] = true;
				break;
			}
		}
		
		return check[0] && check[1] && check[2] && check[3]; 
	}
}
